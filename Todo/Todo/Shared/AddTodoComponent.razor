@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using System.Net.Http.Headers
@*@inject HttpClient Http*@
@inject IAccessTokenProvider TokenProvider
@inject HttpClient Http
@inject RequestHandler Request 

<SfTextBox @ref="Title" Placeholder="Enter Title..." @bind-Value="@todo.Title"></SfTextBox>
<label style="color: tomato; font-size: 10px">@ErrorMessage</label>
<SfTextBox Placeholder="Enter Description..." @bind-Value="@todo.Description"></SfTextBox>
<SfCheckBox Label="Is Completed" @bind-Checked="@todo.IsDone"></SfCheckBox>
<SfButton CssClass="e-info" @onclick="AddTodoRequest">Add</SfButton>



@code {

  protected override async Task OnInitializedAsync()
  {
    //forecasts = await Http.GetFromJsonAsync<WeatherForecast[]>("sample-data/weather.json");
  }

  SfTextBox Title;
  public string ErrorMessage = "";
  public bool IsSucceed { get; set; }
  TodoDetail todo = new TodoDetail();

  private async Task AddTodoRequest(Microsoft.AspNetCore.Components.Web.MouseEventArgs args)
  {
    if (todo != null)
    {
      if (String.IsNullOrWhiteSpace(todo.Title))
      {
        Title.CssClass = "e-error";
      }
      else
      {
        var response = await Request.SendTodoRequest(todo, HttpMethod.Post);
        if (response.IsSuccessStatusCode)
        {
          IsSucceed = true;
        }
      }

    }

  }

}